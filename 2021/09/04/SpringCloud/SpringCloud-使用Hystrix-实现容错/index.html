<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Hexo Theme Keep">
    <meta name="description" content="Hexo Theme Keep">
    <meta name="author" content="Thread丶">
    
    <title>
        
            SpringCloud 使用Hystrix 实现容错 |
        
        Thread丶博客
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    <link rel="shortcut icon" href="/images/%E5%A4%B4%E5%83%8F.jpg">
    
<link rel="stylesheet" href="/css/font-awesome.min.css">

    <script id="hexo-configurations">
    let KEEP = window.KEEP || {};
    KEEP.hexo_config = {"hostname":"example.com","root":"/","language":"zh-CN","path":"search.xml"};
    KEEP.theme_config = {"toc":{"enable":true,"number":true,"expand_all":true,"init_open":true},"style":{"primary_color":"#0066CC","avatar":"/images/头像.jpg","favicon":"/images/头像.jpg","article_img_align":"left","left_side_width":"370px","content_max_width":"920px","hover":{"shadow":true,"scale":true},"first_screen":{"enable":true,"background_img":"/images/bg.svg","description":"梦为努力浇了水 !"},"scroll":{"progress_bar":{"enable":true},"percent":{"enable":true}}},"local_search":{"enable":true,"preload":true},"code_copy":{"enable":true,"style":"default"},"pjax":{"enable":false},"lazyload":{"enable":false},"version":"3.4.3"};
    KEEP.language_ago = {"second":"%s 秒前","minute":"%s 分钟前","hour":"%s 小时前","day":"%s 天前","week":"%s 周前","month":"%s 月前","year":"%s 年前"};
  </script>
<meta name="generator" content="Hexo 5.4.0"></head>


<body>
<div class="progress-bar-container">
    
        <span class="scroll-progress-bar"></span>
    

    
</div>


<main class="page-container">

    

    <div class="page-main-content">

        <div class="page-main-content-top">
            <header class="header-wrapper">

    <div class="header-content">
        <div class="left">
            
            <a class="logo-title" href="/">
                Thread丶博客
            </a>
        </div>

        <div class="right">
            <div class="pc">
                <ul class="menu-list">
                    
                        <li class="menu-item">
                            <a class=""
                               href="/"
                            >
                                首页
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/archives"
                            >
                                归档
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/categories"
                            >
                                分类
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/tags"
                            >
                                标签
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/about"
                            >
                                关于
                            </a>
                        </li>
                    
                    
                        <li class="menu-item search search-popup-trigger">
                            <i class="fas fa-search"></i>
                        </li>
                    
                </ul>
            </div>
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div>
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list">
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/">首页</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/archives">归档</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/categories">分类</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/tags">标签</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/about">关于</a>
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle">

            <div class="main-content">

                
                    <div class="fade-in-down-animation">
    <div class="article-content-container">

        <div class="article-title">
            <span class="title-hover-animation">SpringCloud 使用Hystrix 实现容错</span>
        </div>

        
            <div class="article-header">
                <div class="avatar">
                    <img src="/images/%E5%A4%B4%E5%83%8F.jpg">
                </div>
                <div class="info">
                    <div class="author">
                        <span class="name">Thread丶</span>
                        
                            <span class="author-label">Lv2</span>
                        
                    </div>
                    <div class="meta-info">
                        <div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fas fa-edit"></i>&nbsp;2021-09-04 20:50:04
    </span>
    
    

    
    
    
    
        <span class="article-pv article-meta-item">
            <i class="fas fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

                    </div>
                </div>
            </div>
        

        <div class="article-content markdown-body">
            <h1 id="7-使用-Hystrix-实现容错"><a href="#7-使用-Hystrix-实现容错" class="headerlink" title="7. 使用 Hystrix 实现容错"></a>7. 使用 Hystrix 实现容错</h1><h2 id="7-1-1-雪崩效应"><a href="#7-1-1-雪崩效应" class="headerlink" title="7.1.1 雪崩效应"></a>7.1.1 雪崩效应</h2><p><img src="/2021/09/04/SpringCloud/SpringCloud-%E4%BD%BF%E7%94%A8Hystrix-%E5%AE%9E%E7%8E%B0%E5%AE%B9%E9%94%99/image-20210904205132435.png" alt="image-20210904205132435"></p>
<h2 id="Hystrix-如果实现容错"><a href="#Hystrix-如果实现容错" class="headerlink" title="Hystrix 如果实现容错"></a>Hystrix 如果实现容错</h2><p>Hystrix 提供了一个断路器机制，下面是它的一个运行逻辑</p>
<p>正常情况下 服务A 调用 服务B 能成功的情况下 断路器关闭状态</p>
<p>服务A 调用 服务B 调用不成功 没有到 Hystrix 的阀值 断路器关闭状态，如果到了阀值那么 断路器会进入打开状态</p>
<p>断路器打开一段的时间不在请求依赖的服务，等过一段时间后会进入半开状态，断路器可允许其中一次请求，去尝试请求依赖的服务，如果还是请求失败那么，断路器重新进入打开状态，不在请求依赖的服务，循环往复，直到断路器半开状态，其中一次请求能请求通依赖的服务后，断路器会重新进入关闭状态，服务之间正常调用</p>
<h2 id="7-2-使用-Hystrix-实现容错"><a href="#7-2-使用-Hystrix-实现容错" class="headerlink" title="7.2 使用 Hystrix 实现容错"></a>7.2 使用 Hystrix 实现容错</h2><h3 id="7-2-2-使用通用方式整合Hystrix-RestTemplat-e"><a href="#7-2-2-使用通用方式整合Hystrix-RestTemplat-e" class="headerlink" title="7.2.2 使用通用方式整合Hystrix RestTemplat    e"></a>7.2.2 使用通用方式整合Hystrix RestTemplat    e</h3><h4 id="导入Hystrix的依赖"><a href="#导入Hystrix的依赖" class="headerlink" title="导入Hystrix的依赖"></a>导入Hystrix的依赖</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--Hystrix依赖--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-hystrix<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2.4.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="通过-HystrixCommand注解实现容错"><a href="#通过-HystrixCommand注解实现容错" class="headerlink" title="通过@HystrixCommand注解实现容错"></a>通过@HystrixCommand注解实现容错</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 调用用户服务 根据用户id 获取用户名称</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/getUserNameById&quot;)</span></span><br><span class="line"><span class="comment">//HystrixCommand容错 设置请求失败后的设置回退方法</span></span><br><span class="line"><span class="meta">@HystrixCommand(fallbackMethod = &quot;getUserNameByIdFallBack&quot; </span></span><br><span class="line"><span class="meta">                /*, ignoreExceptions = &#123;ArithmeticException.class&#125;*/)</span> </span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getUserNameById</span><span class="params">(<span class="keyword">int</span> id)</span></span>&#123;</span><br><span class="line">    <span class="comment">//通过 ignoreExceptions 设置过滤掉的异常 当触发这类异常时候不进行容错</span></span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">10</span> / <span class="number">0</span>;</span><br><span class="line">    String url = <span class="string">&quot;http://localhost:8081/getUserNameById?id=&#123;0&#125;&quot;</span>;</span><br><span class="line">    String userName = restTemplate.getForObject(url, String.class, id);</span><br><span class="line">    <span class="keyword">return</span> userName;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 获取用户名称失败后的回退方法 返回一个默认的用户名</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getUserNameByIdFallBack</span><span class="params">(<span class="keyword">int</span> id, Throwable throwable)</span></span>&#123;</span><br><span class="line">    throwable.printStackTrace();</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;错误信息：&quot;</span> + throwable.toString() + <span class="string">&quot;&lt;br/&gt;我是回退方法的用户名Default&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>通过@HystrixCommand注解在RestTemplate方法级别上加上容错，保证在方法失败返回异常的时候，进行一个容错处理，就是指定的<code>fallbackMethod</code>的回退方法的处理，来进行一个错误后的回退处理。<code>ignoreExceptions</code>属性可以指定在出现某种异常时不进行容错</p>
<h3 id="7-2-3-Hystrix-断路器的状态监控与深入理解"><a href="#7-2-3-Hystrix-断路器的状态监控与深入理解" class="headerlink" title="7.2.3 Hystrix 断路器的状态监控与深入理解"></a>7.2.3 Hystrix 断路器的状态监控与深入理解</h3><h4 id="利用SpringBootActuator监控模块查看断路器状态"><a href="#利用SpringBootActuator监控模块查看断路器状态" class="headerlink" title="利用SpringBootActuator监控模块查看断路器状态"></a>利用SpringBootActuator监控模块查看断路器状态</h4><p>引入监控依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--集成监控模块--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>配置监控的设置</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Actuator 配置访问的路径是 根路径/ 然后 暴露全部监控接口</span></span><br><span class="line"><span class="attr">management:</span></span><br><span class="line">  <span class="attr">endpoints:</span></span><br><span class="line">    <span class="attr">web:</span></span><br><span class="line">      <span class="attr">exposure:</span></span><br><span class="line">        <span class="attr">include:</span> <span class="string">&quot;*&quot;</span> <span class="comment">#配置暴露全部的监控接口</span></span><br><span class="line">      <span class="attr">base-path:</span> <span class="string">/</span>  <span class="comment">#配置访问路径</span></span><br><span class="line">  <span class="attr">endpoint:</span></span><br><span class="line">    <span class="attr">health:</span></span><br><span class="line">      <span class="attr">show-details:</span> <span class="string">always</span>  <span class="comment">#配置健康接口显示详细信息</span></span><br></pre></td></tr></table></figure>

<h4 id="查看Hystrix健康状态"><a href="#查看Hystrix健康状态" class="headerlink" title="查看Hystrix健康状态"></a>查看Hystrix健康状态</h4><blockquote>
<p>Hystrix 状态：</p>
<p>默认如果 status = UP  断路器是关闭 一切正常</p>
<p>如果是 status = CIRCUIT_OPEN 说明短路器是打开状态，表示服务不可用状态</p>
</blockquote>
<p>通过地址访问链接的形式查看</p>
<p><img src="/2021/09/04/SpringCloud/SpringCloud-%E4%BD%BF%E7%94%A8Hystrix-%E5%AE%9E%E7%8E%B0%E5%AE%B9%E9%94%99/image-20210904205203053.png" alt="image-20210904205203053"></p>
<p>通过IDEA的Services的Health功能查看</p>
<p><img src="/2021/09/04/SpringCloud/SpringCloud-%E4%BD%BF%E7%94%A8Hystrix-%E5%AE%9E%E7%8E%B0%E5%AE%B9%E9%94%99/image-20210904205213167.png" alt="image-20210904205213167"></p>
<h3 id="7-2-4-Hystrix-线程隔离策略-与-传播上下文"><a href="#7-2-4-Hystrix-线程隔离策略-与-传播上下文" class="headerlink" title="7.2.4 Hystrix 线程隔离策略 与 传播上下文"></a>7.2.4 Hystrix 线程隔离策略 与 传播上下文</h3><blockquote>
<p>Hystrix 隔离策略    线程隔离  和 信号量隔离</p>
<p>线程隔离 ：默认方式，使用这种方式HystrixCommand将会在单独的线程上执行，收到线程池数量的限制</p>
<p>信号量隔离：使用这种方式HystrixCommand将在调用线程上执行，并发请求收到信号量大小的限制</p>
</blockquote>
<p>配置隔离策略</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@HystrixCommand(fallbackMethod = &quot;stubMyService&quot;,commandProperties = &#123;</span></span><br><span class="line"><span class="meta">    //value = &quot;SEMAPHORE&quot; | &quot;THREAD&quot;</span></span><br><span class="line"><span class="meta">    @HystrixProperty(name = &quot;execution.isolation.strategy&quot;, value = &quot;SEMAPHORE&quot;)</span></span><br><span class="line"><span class="meta">&#125;)</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/hello&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">hello</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="7-2-5-Feign-使用-Hystrix"><a href="#7-2-5-Feign-使用-Hystrix" class="headerlink" title="7.2.5 Feign 使用 Hystrix"></a>7.2.5 Feign 使用 Hystrix</h3><p>开启 Hystrix 的支持</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#开启Feign对于Hystrix的容错</span></span><br><span class="line"><span class="attr">feign:</span></span><br><span class="line">  <span class="attr">hystrix:</span></span><br><span class="line">    <span class="attr">enabled:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<h4 id="7-2-5-1-为-Feign-添加回退"><a href="#7-2-5-1-为-Feign-添加回退" class="headerlink" title="7.2.5.1 为 Feign 添加回退"></a>7.2.5.1 为 Feign 添加回退</h4><p>FeignClient 提供一个 fallback 属性，这个属性配置一个当前FeignClient接口的一个实现类，走回退的时候会走实现里的同名方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 用户服务的FeignClient</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Thread丶</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@FeignClient(name = &quot;provider-user&quot;,fallback = UserFeignClientImpl.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserFeignClient</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 根据用户id 获取用户名称</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RequestMapping(value = &quot;/getUserNameById&quot;, method = RequestMethod.GET)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getUserNameById</span><span class="params">(<span class="meta">@RequestParam</span> <span class="keyword">int</span> id)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 第一种方式 实现FeignClient接口 实现Hystrix容错 但是获取不到异常信息</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserFeignClientImpl</span> <span class="keyword">implements</span> <span class="title">UserFeignClient</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getUserNameById</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;default&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="7-2-5-2-通过-FallbackFactory-检查回退原因"><a href="#7-2-5-2-通过-FallbackFactory-检查回退原因" class="headerlink" title="7.2.5.2 通过 FallbackFactory 检查回退原因"></a>7.2.5.2 通过 FallbackFactory 检查回退原因</h4><p>FeignClient 注解还提供一个，fallbackFactory 属性 用于配置 FallbackFactory 属性的实现类，这个接口提供一个create方法用于返回这个FeignClient接口的一个实现类，相当于封装了一层对象，这个 create方法提供一个Throwable 参数用于获取回退的异常信息</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 用户服务的FeignClient</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Thread丶</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@FeignClient(name = &quot;provider-user&quot;, fallbackFactory = UserFeignFallbackFactory.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserFeignClient</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 根据用户id 获取用户名称</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RequestMapping(value = &quot;/getUserNameById&quot;, method = RequestMethod.GET)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getUserNameById</span><span class="params">(<span class="meta">@RequestParam</span> <span class="keyword">int</span> id)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 第二种方式 实现 FallbackFactory 接口 提供Throwable获取错误信息</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserFeignFallbackFactory</span> <span class="keyword">implements</span> <span class="title">FallbackFactory</span>&lt;<span class="title">UserFeignClient</span>&gt; </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> UserFeignClient <span class="title">create</span><span class="params">(Throwable throwable)</span> </span>&#123;</span><br><span class="line">        throwable.printStackTrace();</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> UserFeignClient() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> String <span class="title">getUserNameById</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;default&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="7-2-5-3-为-Feign-禁用-Hystrix"><a href="#7-2-5-3-为-Feign-禁用-Hystrix" class="headerlink" title="7.2.5.3 为 Feign 禁用 Hystrix"></a>7.2.5.3 为 Feign 禁用 Hystrix</h4><p>全局禁用Hystrix</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">feign:</span></span><br><span class="line">  <span class="attr">hystrix:</span></span><br><span class="line">    <span class="attr">enabled:</span> <span class="literal">false</span>  <span class="comment">#全局禁用</span></span><br></pre></td></tr></table></figure>

<p>为单个 FeignClient 禁用 Hystrix</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@FeignClient(name = &quot;provider-user&quot;, configuration = FeignDisableHystrixConfiguration.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserFeignClient</span> </span>&#123;</span><br><span class="line">   ......</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FeignDisableHystrixConfiguration</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@Scope(&quot;prototype&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Feign.<span class="function">Builder <span class="title">feignBuilder</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Feign.Builder();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="7-3-Hystrix-的监控"><a href="#7-3-Hystrix-的监控" class="headerlink" title="7.3 Hystrix 的监控"></a>7.3 Hystrix 的监控</h3><p>默认 Hystrix 提供一个监控的信息页面，但是是 json 格式实时刷新的，但是缺点是不是图形化界面显示</p>
<p>**URL :  ** <code>http://localhost:8080/hystrix.stream</code></p>
<h3 id="7-4-使用-Hystrix-Dashboard-可视化监控数据"><a href="#7-4-使用-Hystrix-Dashboard-可视化监控数据" class="headerlink" title="7.4 使用 Hystrix Dashboard 可视化监控数据"></a>7.4 使用 Hystrix Dashboard 可视化监控数据</h3><p>这里可以新建一个模块引入依赖，主要是Hystrix 和 Hystrix-dashboard 这两个依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">&lt;!--Hystrix Dashboard图形化监控--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-hystrix-dashboard<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2.4.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-hystrix<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2.4.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>启动HystrDashboard，在启动类上开启  <code>@EnableHystrixDashboard</code> 监控功能</p>
<p>访问这个模块的 <code>http://localhost:888/hystrix</code> 就可以看到监控页面，</p>
<p>最上面的url填 <code>http://localhost:8080/hystrix.stream</code> 每个服务的监控数据的url，</p>
<p>然后下面是 Delay 延迟毫秒数， Title监控的标题</p>
<p><img src="/2021/09/04/SpringCloud/SpringCloud-%E4%BD%BF%E7%94%A8Hystrix-%E5%AE%9E%E7%8E%B0%E5%AE%B9%E9%94%99/image-20210904205242278.png" alt="image-20210904205242278"></p>
<p><img src="/2021/09/04/SpringCloud/SpringCloud-%E4%BD%BF%E7%94%A8Hystrix-%E5%AE%9E%E7%8E%B0%E5%AE%B9%E9%94%99/image-20210904205251005.png" alt="image-20210904205251005"></p>
<h3 id="7-5-使用-Turbine-聚合监控数据"><a href="#7-5-使用-Turbine-聚合监控数据" class="headerlink" title="7.5 使用 Turbine 聚合监控数据"></a>7.5 使用 Turbine 聚合监控数据</h3><blockquote>
<p>Turbine 可以同时监控多个微服务，把所有的微服务的数据汇合到一起，</p>
<p>然后通过统一的url：<code>http://localhost:889/turbine.stream</code>获取全部数据，</p>
<p>配合 HystrDashboard 图形化显示全部微服务的监控情况</p>
</blockquote>
<p>这里也是新建一个模块，然后添加依赖，Turbine 需要注册到Eureka上，因为要获取服务注册信息</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-hystrix-dashboard<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2.4.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--引入Turbine监控多个微服务--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-turbine<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2.4.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2.4.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-hystrix<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2.4.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>这里主要是配置 turbine.app-config 设置要监控的多个微服务，名称就是 Eureka 里的服务名</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">889</span></span><br><span class="line"></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">hystrix-turbine</span></span><br><span class="line">    </span><br><span class="line"><span class="comment">#配置EurekaCleint</span></span><br><span class="line"><span class="attr">eureka:</span></span><br><span class="line">  <span class="attr">client:</span></span><br><span class="line">    <span class="attr">fetch-registry:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">register-with-eureka:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">service-url:</span></span><br><span class="line">      <span class="attr">defaultZone:</span> <span class="string">http://localhost:777/eureka</span></span><br><span class="line">  <span class="attr">instance:</span></span><br><span class="line">    <span class="attr">prefer-ip-address:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#配置Turbine监控设置</span></span><br><span class="line"><span class="comment">#turbine url  http://localhost:889/turbine.stream</span></span><br><span class="line"><span class="attr">turbine:</span></span><br><span class="line">  <span class="attr">app-config:</span> <span class="string">thread-consumer</span> <span class="comment">#配置汇总监控信息的服务,这里可以写多个服务名</span></span><br><span class="line">  <span class="attr">cluster-name-expression:</span> <span class="string">&quot;&#x27;default&#x27;&quot;</span></span><br><span class="line">  <span class="comment">#这个属性可能联想不出来  但是可以设置 instanceUrlSuffix 因为默认访问服务的都是 http://localhost:889/xxx/turbine.stream</span></span><br><span class="line">  <span class="attr">instanceUrlSuffix:</span> <span class="string">hystrix.stream</span></span><br></pre></td></tr></table></figure>

<p>在启动类上开始Turbine功能，增加注解 <code>@EnableTurbine</code>，然后访问 <code>http://localhost:889/turbine.stream</code>就可以看到汇总的数据了</p>
<h3 id="7-6-使用消息中间件收集数据-RabbitMQ"><a href="#7-6-使用消息中间件收集数据-RabbitMQ" class="headerlink" title="7.6 使用消息中间件收集数据 RabbitMQ"></a>7.6 使用消息中间件收集数据 RabbitMQ</h3><p>这里我用Docker 镜像版的 RabbitMQ ，不知道为啥windows版本地老是报错</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#拉取docker镜像</span></span><br><span class="line">docker pull rabbitmq</span><br><span class="line"><span class="comment">#启动rabbitmq</span></span><br><span class="line">docker run -d --name rabbitmq -p 15672:15672 -p 5672:5672 rabbitmq</span><br><span class="line"><span class="comment">#进入容器安装 图形化管理界面</span></span><br><span class="line">docker ps <span class="comment">#看一下那个容器id</span></span><br><span class="line">docker <span class="built_in">exec</span> -it a69bba256723 bash</span><br><span class="line"><span class="comment">#安装图形化管理界面</span></span><br><span class="line">rabbitmq-plugins <span class="built_in">enable</span> rabbitmq_management</span><br></pre></td></tr></table></figure>

<p>然后就可以访问管理了，用户名和密码默认是 guest guest</p>
<p><img src="/2021/09/04/SpringCloud/SpringCloud-%E4%BD%BF%E7%94%A8Hystrix-%E5%AE%9E%E7%8E%B0%E5%AE%B9%E9%94%99/image-20210904205300544.png" alt="image-20210904205300544"></p>

        </div>

        
            <div class="post-copyright-info">
                <div class="article-copyright-info-container">
    <ul>
        <li>本文标题：SpringCloud 使用Hystrix 实现容错</li>
        <li>本文作者：Thread丶</li>
        <li>创建时间：2021-09-04 20:50:04</li>
        <li>
            本文链接：https://thread-blog.org/2021/09/04/SpringCloud/SpringCloud-使用Hystrix-实现容错/
        </li>
        <li>
            版权声明：本博客所有文章除特别声明外，均采用 <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">BY-NC-SA</a> 许可协议。转载请注明出处！
        </li>
    </ul>
</div>

            </div>
        

        
            <div class="article-nav">
                
                
                    <div class="article-next">
                        <a class="next"
                           rel="next"
                           href="/2021/09/04/SpringCloud/SpringCloud-Ribbon%E5%AE%9E%E7%8E%B0%E5%AE%A2%E6%88%B7%E7%AB%AF%E4%BE%A7%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/"
                        >
                            <span class="title flex-center">
                                <span class="post-nav-title-item">SpringCloud Ribbon实现客户端侧负载均衡</span>
                                <span class="post-nav-item">下一篇</span>
                            </span>
                            <span class="right arrow-icon flex-center">
                              <i class="fas fa-chevron-right"></i>
                            </span>
                        </a>
                    </div>
                
            </div>
        

        
            <div class="comment-container">
                <div class="comments-container">
    <div id="comment-anchor"></div>
    <div class="comment-area-title">
        <i class="fas fa-comments">&nbsp;评论</i>
    </div>
    

        
            


        
    
</div>

            </div>
        
    </div>
</div>


                
            </div>

        </div>

        <div class="page-main-content-bottom">
            <footer class="footer">
    <div class="info-container">
        <div class="copyright-info info-item">
            &copy;
            
              <span>2020</span>&nbsp;-&nbsp;
            
            2021&nbsp;<i class="fas fa-heart icon-animate"></i>&nbsp;<a href="/">Thread丶</a>
        </div>
        
            <script async  src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <div class="website-count info-item">
                
                    <span id="busuanzi_container_site_uv">
                        访问人数&nbsp;<span id="busuanzi_value_site_uv"></span>&ensp;
                    </span>
                
                
                    <span id="busuanzi_container_site_pv">
                        总访问量&nbsp;<span id="busuanzi_value_site_pv"></span>
                    </span>
                
            </div>
        
        <div class="theme-info info-item">
            由 <a target="_blank" href="https://hexo.io">Hexo</a> 驱动&nbsp;|&nbsp;主题&nbsp;<a class="theme-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep v3.4.3</a>
        </div>
        
    </div>
</footer>

        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="tools-list">
        <!-- TOC aside toggle -->
        
            <li class="tools-item page-aside-toggle">
                <i class="fas fa-outdent"></i>
            </li>
        

        <!-- go comment -->
        
            <li class="go-comment">
                <i class="fas fa-comment"></i>
            </li>
        
    </ul>
</div>

        </div>
    

    <div class="right-bottom-side-tools">
        <div class="side-tools-container">
    <ul class="side-tools-list">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <li class="tools-item tool-expand-width flex-center">
            <i class="fas fa-arrows-alt-h"></i>
        </li>

        <li class="tools-item tool-dark-light-toggle flex-center">
            <i class="fas fa-moon"></i>
        </li>

        <!-- rss -->
        

        

        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list">
        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>
        
            <li class="tools-item tool-scroll-to-top flex-center">
                <i class="arrow-up fas fa-arrow-up"></i>
                <span class="percent"></span>
            </li>
        
    </ul>
</div>

    </div>

    
        <aside class="page-aside">
            <div class="post-toc-wrap">
    <div class="post-toc">
        <ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#7-%E4%BD%BF%E7%94%A8-Hystrix-%E5%AE%9E%E7%8E%B0%E5%AE%B9%E9%94%99"><span class="nav-number">1.</span> <span class="nav-text">7. 使用 Hystrix 实现容错</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#7-1-1-%E9%9B%AA%E5%B4%A9%E6%95%88%E5%BA%94"><span class="nav-number">1.1.</span> <span class="nav-text">7.1.1 雪崩效应</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Hystrix-%E5%A6%82%E6%9E%9C%E5%AE%9E%E7%8E%B0%E5%AE%B9%E9%94%99"><span class="nav-number">1.2.</span> <span class="nav-text">Hystrix 如果实现容错</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-2-%E4%BD%BF%E7%94%A8-Hystrix-%E5%AE%9E%E7%8E%B0%E5%AE%B9%E9%94%99"><span class="nav-number">1.3.</span> <span class="nav-text">7.2 使用 Hystrix 实现容错</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#7-2-2-%E4%BD%BF%E7%94%A8%E9%80%9A%E7%94%A8%E6%96%B9%E5%BC%8F%E6%95%B4%E5%90%88Hystrix-RestTemplat-e"><span class="nav-number">1.3.1.</span> <span class="nav-text">7.2.2 使用通用方式整合Hystrix RestTemplat    e</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AF%BC%E5%85%A5Hystrix%E7%9A%84%E4%BE%9D%E8%B5%96"><span class="nav-number">1.3.1.1.</span> <span class="nav-text">导入Hystrix的依赖</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%80%9A%E8%BF%87-HystrixCommand%E6%B3%A8%E8%A7%A3%E5%AE%9E%E7%8E%B0%E5%AE%B9%E9%94%99"><span class="nav-number">1.3.1.2.</span> <span class="nav-text">通过@HystrixCommand注解实现容错</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-2-3-Hystrix-%E6%96%AD%E8%B7%AF%E5%99%A8%E7%9A%84%E7%8A%B6%E6%80%81%E7%9B%91%E6%8E%A7%E4%B8%8E%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3"><span class="nav-number">1.3.2.</span> <span class="nav-text">7.2.3 Hystrix 断路器的状态监控与深入理解</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%A9%E7%94%A8SpringBootActuator%E7%9B%91%E6%8E%A7%E6%A8%A1%E5%9D%97%E6%9F%A5%E7%9C%8B%E6%96%AD%E8%B7%AF%E5%99%A8%E7%8A%B6%E6%80%81"><span class="nav-number">1.3.2.1.</span> <span class="nav-text">利用SpringBootActuator监控模块查看断路器状态</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8BHystrix%E5%81%A5%E5%BA%B7%E7%8A%B6%E6%80%81"><span class="nav-number">1.3.2.2.</span> <span class="nav-text">查看Hystrix健康状态</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-2-4-Hystrix-%E7%BA%BF%E7%A8%8B%E9%9A%94%E7%A6%BB%E7%AD%96%E7%95%A5-%E4%B8%8E-%E4%BC%A0%E6%92%AD%E4%B8%8A%E4%B8%8B%E6%96%87"><span class="nav-number">1.3.3.</span> <span class="nav-text">7.2.4 Hystrix 线程隔离策略 与 传播上下文</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-2-5-Feign-%E4%BD%BF%E7%94%A8-Hystrix"><span class="nav-number">1.3.4.</span> <span class="nav-text">7.2.5 Feign 使用 Hystrix</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#7-2-5-1-%E4%B8%BA-Feign-%E6%B7%BB%E5%8A%A0%E5%9B%9E%E9%80%80"><span class="nav-number">1.3.4.1.</span> <span class="nav-text">7.2.5.1 为 Feign 添加回退</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#7-2-5-2-%E9%80%9A%E8%BF%87-FallbackFactory-%E6%A3%80%E6%9F%A5%E5%9B%9E%E9%80%80%E5%8E%9F%E5%9B%A0"><span class="nav-number">1.3.4.2.</span> <span class="nav-text">7.2.5.2 通过 FallbackFactory 检查回退原因</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#7-2-5-3-%E4%B8%BA-Feign-%E7%A6%81%E7%94%A8-Hystrix"><span class="nav-number">1.3.4.3.</span> <span class="nav-text">7.2.5.3 为 Feign 禁用 Hystrix</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-3-Hystrix-%E7%9A%84%E7%9B%91%E6%8E%A7"><span class="nav-number">1.3.5.</span> <span class="nav-text">7.3 Hystrix 的监控</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-4-%E4%BD%BF%E7%94%A8-Hystrix-Dashboard-%E5%8F%AF%E8%A7%86%E5%8C%96%E7%9B%91%E6%8E%A7%E6%95%B0%E6%8D%AE"><span class="nav-number">1.3.6.</span> <span class="nav-text">7.4 使用 Hystrix Dashboard 可视化监控数据</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-5-%E4%BD%BF%E7%94%A8-Turbine-%E8%81%9A%E5%90%88%E7%9B%91%E6%8E%A7%E6%95%B0%E6%8D%AE"><span class="nav-number">1.3.7.</span> <span class="nav-text">7.5 使用 Turbine 聚合监控数据</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-6-%E4%BD%BF%E7%94%A8%E6%B6%88%E6%81%AF%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%94%B6%E9%9B%86%E6%95%B0%E6%8D%AE-RabbitMQ"><span class="nav-number">1.3.8.</span> <span class="nav-text">7.6 使用消息中间件收集数据 RabbitMQ</span></a></li></ol></li></ol></li></ol>
    </div>
</div>
        </aside>
    

    <div class="image-viewer-container">
    <img src="">
</div>


    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fas fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="搜索..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="popup-btn-close">
                <i class="fas fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

</main>




<script src="/js/utils.js"></script>

<script src="/js/main.js"></script>

<script src="/js/header-shrink.js"></script>

<script src="/js/back2top.js"></script>

<script src="/js/dark-light-toggle.js"></script>



    
<script src="/js/local-search.js"></script>




    
<script src="/js/code-copy.js"></script>





<div class="post-scripts">
    
        
<script src="/js/left-side-toggle.js"></script>

<script src="/js/libs/anime.min.js"></script>

<script src="/js/toc.js"></script>

    
</div>



</body>
</html>
